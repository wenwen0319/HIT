2021-06-12 02:50:06,003 - root - INFO - Create log file at log/1623480606.0036976-tags-ask-ubuntu-t-walk-2-64k2-108-lp-1e-05.log
2021-06-12 02:50:06,004 - root - INFO - Command line executed: python main.py -d tags-ask-ubuntu --gpu 7
2021-06-12 02:50:06,004 - root - INFO - Full args parsed:
2021-06-12 02:50:06,004 - root - INFO - Namespace(ablation=False, ablation_type=0, agg='walk', attn_agg_method='attn', attn_mode='prod', attn_n_head=2, bias=1e-05, bs=64, cpu_cores=1, data='tags-ask-ubuntu', data_usage=1.0, debug=False, drop_out=0.1, gpu=7, interpretation=False, interpretation_type=0, lr=0.0001, mode='t', model='tgat', n_degree=['64', '2'], n_epoch=50, n_layer=1, negative='Nega20', ngh_cache=False, pos_dim=108, pos_enc='lp', pos_sample='multinomial', seed=2, test_baselines=False, test_path=None, time='time', time_dim=164, time_prediction=False, time_prediction_type=0, tolerance=0.001, verbosity=1, walk_linear_out=False, walk_mutual=False, walk_n_head=8, walk_pool='attn')
2021-06-12 02:50:06,004 - root - INFO - Create checkpoint directory ./saved_checkpoints/1623480606.0036976-tags-ask-ubuntu-t-walk-2-64k2-108-lp-1e-05/
2021-06-12 02:50:06,004 - root - INFO - Create best model directory ./best_models/1623480606.0036976-tags-ask-ubuntu-t-walk-2-64k2-108-lp-1e-05/
2021-06-12 02:50:24,128 - module - INFO - neighbors: [64, 2], pos dim: 108, edge dim: 164
2021-06-12 02:50:24,128 - module - INFO - Using time encoding
2021-06-12 02:50:24,129 - module - INFO - Distance encoding: lp
2021-06-12 02:50:24,137 - module - INFO - bi-lstm actual encoding dim: 272 + 108, attention dim: 136, attention heads: 8
2021-06-12 02:50:41,100 - root - INFO - False
2021-06-12 02:50:41,101 - root - INFO - num of training instances: 120000
2021-06-12 02:50:41,101 - root - INFO - num of batches per epoch: 1875
2021-06-12 02:50:47,284 - root - INFO - start 0 epoch
2021-06-12 03:44:07,911 - root - INFO - confusion matrix: 
2021-06-12 03:44:07,912 - root - INFO - [12364  8731  3983  4922  8534 11110  3917  6439  7624  7837  5498  9041
  3646  5050  4025 17279]
2021-06-12 03:56:48,447 - root - INFO - confusion matrix: 
2021-06-12 03:56:48,447 - root - INFO - [2525 1729  863  883 1733 2270 1141  856 1263 1248 1874 1615  368  423
  777 4432]
2021-06-12 04:10:33,871 - root - INFO - confusion matrix: 
2021-06-12 04:10:33,873 - root - INFO - [2654 1683  755  908 2064 1782  786 1368 1117  949 1975 1959  505  547
  780 4168]
2021-06-12 04:10:33,873 - root - INFO - epoch: 0:
2021-06-12 04:10:33,873 - root - INFO - epoch mean loss: 1.2788345532417298
2021-06-12 04:10:33,873 - root - INFO - train acc: 0.385425, val acc: 0.4625416666666667, test acc: 0.4407916666666667
2021-06-12 04:10:33,873 - root - INFO - train auc: 0.6565442354629629, val auc: 0.7279770775462964, test auc: 0.7220341446759259
2021-06-12 04:10:33,873 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 04:10:41,702 - root - INFO - start 1 epoch
2021-06-12 05:03:05,148 - root - INFO - confusion matrix: 
2021-06-12 05:03:05,149 - root - INFO - [14115  7234  4172  4479  7224 11992  5739  5045  4863  6740 13348  5049
  2108  3757  3069 21066]
2021-06-12 05:15:52,152 - root - INFO - confusion matrix: 
2021-06-12 05:15:52,153 - root - INFO - [3383 1405  451  761 1232 3160 1024  584  942 1989 2418  651  443  858
  257 4442]
2021-06-12 05:29:35,868 - root - INFO - confusion matrix: 
2021-06-12 05:29:35,869 - root - INFO - [3014 1766  596  624 1329 3014  946  711  638 1645 3277  440  462  904
  173 4461]
2021-06-12 05:29:35,869 - root - INFO - epoch: 1:
2021-06-12 05:29:35,869 - root - INFO - epoch mean loss: 1.1319830561637878
2021-06-12 05:29:35,869 - root - INFO - train acc: 0.5043416666666667, val acc: 0.5584583333333333, test acc: 0.5735833333333333
2021-06-12 05:29:35,869 - root - INFO - train auc: 0.7562553650462964, val auc: 0.7938197939814815, test auc: 0.8064052118055557
2021-06-12 05:29:35,869 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 05:29:42,175 - root - INFO - start 2 epoch
2021-06-12 06:22:16,233 - root - INFO - confusion matrix: 
2021-06-12 06:22:16,233 - root - INFO - [15162  6329  3888  4621  6242 13282  6255  4221  3590  7066 16046  3298
  2239  3196  1876 22689]
2021-06-12 06:35:07,590 - root - INFO - confusion matrix: 
2021-06-12 06:35:07,591 - root - INFO - [3444  778  789  989 1209 2169 1752  870  828 1045 3323  804  373  370
  316 4941]
2021-06-12 06:48:50,103 - root - INFO - confusion matrix: 
2021-06-12 06:48:50,104 - root - INFO - [3010 1091 1171  728 1366 1961 1804  869  576  795 4240  389  406  442
  300 4852]
2021-06-12 06:48:50,104 - root - INFO - epoch: 2:
2021-06-12 06:48:50,104 - root - INFO - epoch mean loss: 1.0535523386001586
2021-06-12 06:48:50,104 - root - INFO - train acc: 0.559825, val acc: 0.5782083333333333, test acc: 0.5859583333333334
2021-06-12 06:48:50,104 - root - INFO - train auc: 0.7925821099074073, val auc: 0.8111512835648149, test auc: 0.8208476909722222
2021-06-12 06:48:50,105 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 06:48:56,469 - root - INFO - start 3 epoch
2021-06-12 07:41:15,538 - root - INFO - confusion matrix: 
2021-06-12 07:41:15,538 - root - INFO - [15408  6315  3797  4480  6194 13467  6319  4020  3380  6963 16526  3131
  2146  3116  1776 22962]
2021-06-12 07:54:01,135 - root - INFO - confusion matrix: 
2021-06-12 07:54:01,136 - root - INFO - [3356  995  676  973 1102 2558 1544  796  776 1294 3194  736  389  396
  249 4966]
2021-06-12 08:07:45,059 - root - INFO - confusion matrix: 
2021-06-12 08:07:45,059 - root - INFO - [2892 1273 1025  810 1166 2316 1602  916  483  978 4092  447  377  488
  216 4919]
2021-06-12 08:07:45,059 - root - INFO - epoch: 3:
2021-06-12 08:07:45,059 - root - INFO - epoch mean loss: 1.0321656485239665
2021-06-12 08:07:45,059 - root - INFO - train acc: 0.5696916666666667, val acc: 0.5864166666666667, test acc: 0.5924583333333333
2021-06-12 08:07:45,060 - root - INFO - train auc: 0.8013653818055555, val auc: 0.8186965706018519, test auc: 0.8210381423611111
2021-06-12 08:07:45,060 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 08:07:53,163 - root - INFO - start 4 epoch
2021-06-12 09:00:25,998 - root - INFO - confusion matrix: 
2021-06-12 09:00:25,998 - root - INFO - [15569  6137  4011  4283  5976 13862  6281  3881  3358  6837 16701  3104
  2072  2979  1742 23207]
2021-06-12 09:13:03,928 - root - INFO - confusion matrix: 
2021-06-12 09:13:03,928 - root - INFO - [3219 1078  506 1197 1039 2511 1176 1274  765 1355 2619 1261  273  271
  131 5325]
2021-06-12 09:26:47,494 - root - INFO - confusion matrix: 
2021-06-12 09:26:47,495 - root - INFO - [2697 1317 1010  976 1043 2141 1660 1156  441  873 4083  603  332  305
  167 5196]
2021-06-12 09:26:47,495 - root - INFO - epoch: 4:
2021-06-12 09:26:47,495 - root - INFO - epoch mean loss: 1.0169163558006287
2021-06-12 09:26:47,495 - root - INFO - train acc: 0.577825, val acc: 0.56975, test acc: 0.5882083333333333
2021-06-12 09:26:47,495 - root - INFO - train auc: 0.807644153611111, val auc: 0.8127625949074073, test auc: 0.8219603564814815
2021-06-12 09:26:47,495 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 09:26:53,805 - root - INFO - start 5 epoch
2021-06-12 10:19:22,391 - root - INFO - confusion matrix: 
2021-06-12 10:19:22,391 - root - INFO - [15473  6244  4008  4275  6093 14020  6052  3835  3325  6965 16790  2920
  2083  2970  1834 23113]
2021-06-12 10:31:59,811 - root - INFO - confusion matrix: 
2021-06-12 10:31:59,811 - root - INFO - [3677  907  680  736 1391 2523 1348  738  975 1262 3073  690  484  410
  325 4781]
2021-06-12 10:45:37,250 - root - INFO - confusion matrix: 
2021-06-12 10:45:37,250 - root - INFO - [3273 1077 1042  608 1462 2164 1581  793  609  883 4163  345  529  444
  249 4778]
2021-06-12 10:45:37,250 - root - INFO - epoch: 5:
2021-06-12 10:45:37,250 - root - INFO - epoch mean loss: 1.0135103798866272
2021-06-12 10:45:37,250 - root - INFO - train acc: 0.5783, val acc: 0.5855833333333333, test acc: 0.5990833333333333
2021-06-12 10:45:37,250 - root - INFO - train auc: 0.8091910447222221, val auc: 0.8178003611111111, test auc: 0.8237770277777777
2021-06-12 10:45:37,251 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 10:45:46,863 - root - INFO - start 6 epoch
2021-06-12 11:38:25,281 - root - INFO - confusion matrix: 
2021-06-12 11:38:25,282 - root - INFO - [15700  6117  3908  4275  6047 14204  6021  3728  3279  6744 17142  2835
  2108  2898  1888 23106]
2021-06-12 11:50:59,667 - root - INFO - confusion matrix: 
2021-06-12 11:50:59,668 - root - INFO - [3149  963  666 1222 1038 2245 1512 1205  700 1071 3067 1162  216  206
  158 5420]
2021-06-12 12:04:41,718 - root - INFO - confusion matrix: 
2021-06-12 12:04:41,719 - root - INFO - [2756 1149 1020 1075 1087 2104 1512 1297  460  874 3972  694  283  273
  156 5288]
2021-06-12 12:04:41,719 - root - INFO - epoch: 6:
2021-06-12 12:04:41,719 - root - INFO - epoch mean loss: 1.0036785160064696
2021-06-12 12:04:41,719 - root - INFO - train acc: 0.5846, val acc: 0.578375, test acc: 0.5883333333333334
2021-06-12 12:04:41,719 - root - INFO - train auc: 0.8134454084722222, val auc: 0.8204221782407407, test auc: 0.8182756608796297
2021-06-12 12:04:41,719 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 12:04:48,010 - root - INFO - start 7 epoch
2021-06-12 12:57:31,028 - root - INFO - confusion matrix: 
2021-06-12 12:57:31,028 - root - INFO - [15843  5999  3988  4170  6119 14155  6022  3704  3409  6717 16970  2904
  2049  2903  1794 23254]
2021-06-12 13:10:06,395 - root - INFO - confusion matrix: 
2021-06-12 13:10:06,395 - root - INFO - [3559  973  739  729 1281 2671 1487  561  887 1260 3267  586  459  459
  394 4688]
2021-06-12 13:23:43,825 - root - INFO - confusion matrix: 
2021-06-12 13:23:43,826 - root - INFO - [2990 1387 1024  599 1195 2574 1519  712  442 1199 4019  340  401  673
  362 4564]
2021-06-12 13:23:43,826 - root - INFO - epoch: 7:
2021-06-12 13:23:43,826 - root - INFO - epoch mean loss: 0.9999239082018534
2021-06-12 13:23:43,826 - root - INFO - train acc: 0.5851833333333334, val acc: 0.5910416666666667, test acc: 0.5894583333333333
2021-06-12 13:23:43,826 - root - INFO - train auc: 0.8147121585648148, val auc: 0.8222454166666666, test auc: 0.8216392453703705
2021-06-12 13:23:43,826 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 13:23:50,055 - root - INFO - start 8 epoch
2021-06-12 14:16:13,508 - root - INFO - confusion matrix: 
2021-06-12 14:16:13,509 - root - INFO - [15818  6078  3915  4189  6090 14188  6031  3691  3378  6559 17257  2806
  2006  2786  1793 23415]
2021-06-12 14:28:52,618 - root - INFO - confusion matrix: 
2021-06-12 14:28:52,619 - root - INFO - [3237  797  709 1257 1029 2095 1571 1305  699  852 3386 1063  212  189
  255 5344]
2021-06-12 14:42:35,173 - root - INFO - confusion matrix: 
2021-06-12 14:42:35,173 - root - INFO - [2731 1065 1130 1074 1028 1877 1820 1275  395  696 4312  597  202  255
  202 5341]
2021-06-12 14:42:35,173 - root - INFO - epoch: 8:
2021-06-12 14:42:35,174 - root - INFO - epoch mean loss: 0.9954674276351929
2021-06-12 14:42:35,174 - root - INFO - train acc: 0.5889833333333333, val acc: 0.5859166666666666, test acc: 0.5942083333333333
2021-06-12 14:42:35,174 - root - INFO - train auc: 0.8164762636574073, val auc: 0.823926556712963, test auc: 0.8274210590277777
2021-06-12 14:42:35,174 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 14:42:41,388 - root - INFO - start 9 epoch
2021-06-12 15:35:32,163 - root - INFO - confusion matrix: 
2021-06-12 15:35:32,164 - root - INFO - [15851  6008  4006  4135  6162 14183  6011  3644  3343  6627 17194  2836
  2079  2687  1881 23353]
2021-06-12 15:48:15,044 - root - INFO - confusion matrix: 
2021-06-12 15:48:15,044 - root - INFO - [3585 1121  554  740 1235 3198  991  576  898 1560 2948  594  427  525
  251 4797]
2021-06-12 16:02:01,803 - root - INFO - confusion matrix: 
2021-06-12 16:02:01,804 - root - INFO - [3125 1253  968  654 1262 2542 1439  757  488 1138 4031  343  370  507
  245 4878]
2021-06-12 16:02:01,804 - root - INFO - epoch: 9:
2021-06-12 16:02:01,804 - root - INFO - epoch mean loss: 0.9944197996139527
2021-06-12 16:02:01,804 - root - INFO - train acc: 0.588175, val acc: 0.6053333333333333, test acc: 0.6073333333333333
2021-06-12 16:02:01,804 - root - INFO - train auc: 0.8171005654166666, val auc: 0.8321424201388888, test auc: 0.8301014548611111
2021-06-12 16:02:01,805 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 16:02:08,091 - root - INFO - start 10 epoch
2021-06-12 16:54:49,938 - root - INFO - confusion matrix: 
2021-06-12 16:54:49,938 - root - INFO - [16021  5893  3956  4130  6154 14098  5977  3771  3344  6576 17305  2775
  2012  2687  1776 23525]
2021-06-12 17:07:38,678 - root - INFO - confusion matrix: 
2021-06-12 17:07:38,679 - root - INFO - [3550  970  695  785 1214 2573 1477  736  877 1207 3284  632  367  324
  321 4988]
2021-06-12 17:21:23,753 - root - INFO - confusion matrix: 
2021-06-12 17:21:23,754 - root - INFO - [2940 1335  972  753 1188 2307 1609  896  522  991 4042  445  387  442
  310 4861]
2021-06-12 17:21:23,754 - root - INFO - epoch: 10:
2021-06-12 17:21:23,754 - root - INFO - epoch mean loss: 0.9881128933270772
2021-06-12 17:21:23,754 - root - INFO - train acc: 0.5912416666666667, val acc: 0.5997916666666666, test acc: 0.5895833333333333
2021-06-12 17:21:23,754 - root - INFO - train auc: 0.8190264350462964, val auc: 0.8291217222222222, test auc: 0.8203173877314814
2021-06-12 17:21:23,754 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 17:21:30,041 - root - INFO - start 11 epoch
2021-06-12 18:14:45,543 - root - INFO - confusion matrix: 
2021-06-12 18:14:45,543 - root - INFO - [15948  5972  3962  4118  5954 14348  6039  3659  3322  6537 17446  2695
  1982  2737  1820 23461]
2021-06-12 18:27:35,374 - root - INFO - confusion matrix: 
2021-06-12 18:27:35,374 - root - INFO - [3520  886  688  906 1199 2481 1497  823  773 1050 3386  791  348  321
  260 5071]
2021-06-12 18:41:21,445 - root - INFO - confusion matrix: 
2021-06-12 18:41:21,445 - root - INFO - [3011 1047 1095  847 1191 1988 1870  951  441  747 4416  396  388  286
  202 5124]
2021-06-12 18:41:21,445 - root - INFO - epoch: 11:
2021-06-12 18:41:21,446 - root - INFO - epoch mean loss: 0.9861407410939534
2021-06-12 18:41:21,446 - root - INFO - train acc: 0.5933583333333333, val acc: 0.6024166666666667, test acc: 0.6057916666666666
2021-06-12 18:41:21,446 - root - INFO - train auc: 0.8200224183796296, val auc: 0.830952576388889, test auc: 0.8318367638888888
2021-06-12 18:41:21,446 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 18:41:27,864 - root - INFO - start 12 epoch
2021-06-12 19:34:40,615 - root - INFO - confusion matrix: 
2021-06-12 19:34:40,615 - root - INFO - [16038  5878  3953  4131  6027 14253  6043  3677  3199  6513 17546  2742
  1954  2576  1927 23543]
2021-06-12 19:47:24,154 - root - INFO - confusion matrix: 
2021-06-12 19:47:24,154 - root - INFO - [3366 1319  542  773 1095 3283 1009  613  737 1706 2919  638  300  555
  250 4895]
2021-06-12 20:01:07,873 - root - INFO - confusion matrix: 
2021-06-12 20:01:07,875 - root - INFO - [2871 1421  950  758 1077 2656 1382  885  434 1153 4053  360  325  528
  217 4930]
2021-06-12 20:01:07,875 - root - INFO - epoch: 12:
2021-06-12 20:01:07,875 - root - INFO - epoch mean loss: 0.9828608756701152
2021-06-12 20:01:07,875 - root - INFO - train acc: 0.5948333333333333, val acc: 0.602625, test acc: 0.6045833333333334
2021-06-12 20:01:07,875 - root - INFO - train auc: 0.8215680614814814, val auc: 0.8315145972222222, test auc: 0.830954863425926
2021-06-12 20:01:07,876 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 20:01:14,181 - root - INFO - start 13 epoch
2021-06-12 20:53:59,207 - root - INFO - confusion matrix: 
2021-06-12 20:53:59,207 - root - INFO - [15990  5869  3982  4159  6105 14338  5936  3621  3266  6305 17720  2709
  1979  2678  1884 23459]
2021-06-12 21:06:45,670 - root - INFO - confusion matrix: 
2021-06-12 21:06:45,671 - root - INFO - [3548  967  687  798 1180 2820 1326  674  850 1218 3308  624  409  399
  331 4861]
2021-06-12 21:20:31,464 - root - INFO - confusion matrix: 
2021-06-12 21:20:31,464 - root - INFO - [2842 1386 1052  720 1002 2437 1668  893  413 1007 4195  385  334  477
  273 4916]
2021-06-12 21:20:31,464 - root - INFO - epoch: 13:
2021-06-12 21:20:31,464 - root - INFO - epoch mean loss: 0.9827543632825215
2021-06-12 21:20:31,464 - root - INFO - train acc: 0.5958916666666667, val acc: 0.6057083333333333, test acc: 0.5995833333333334
2021-06-12 21:20:31,465 - root - INFO - train auc: 0.8215442505092592, val auc: 0.8301409259259259, test auc: 0.8251665358796296
2021-06-12 21:20:31,465 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 21:20:39,838 - root - INFO - start 14 epoch
2021-06-12 22:13:40,483 - root - INFO - confusion matrix: 
2021-06-12 22:13:40,484 - root - INFO - [16186  5698  4002  4114  6221 14133  6169  3477  3248  6446 17686  2620
  2060  2596  1826 23518]
2021-06-12 22:26:29,658 - root - INFO - confusion matrix: 
2021-06-12 22:26:29,658 - root - INFO - [3310 1006  637 1047 1111 2783 1211  895  806 1262 3041  891  225  337
  241 5197]
2021-06-12 22:40:17,551 - root - INFO - confusion matrix: 
2021-06-12 22:40:17,552 - root - INFO - [2736 1263 1049  952  969 2264 1614 1153  388  944 4192  476  247  324
  179 5250]
2021-06-12 22:40:17,552 - root - INFO - epoch: 14:
2021-06-12 22:40:17,552 - root - INFO - epoch mean loss: 0.9779416014035542
2021-06-12 22:40:17,552 - root - INFO - train acc: 0.596025, val acc: 0.597125, test acc: 0.60175
2021-06-12 22:40:17,552 - root - INFO - train auc: 0.8231850237962963, val auc: 0.8271396423611111, test auc: 0.8305818159722224
2021-06-12 22:40:17,552 - root - INFO - train ap: 1.0, val ap: 1.0, test ap: 1.0
2021-06-12 22:40:17,552 - root - INFO - No improvment over 5 epochs, stop training
2021-06-12 22:40:17,552 - root - INFO - Loading the best model at epoch 10
2021-06-12 22:40:17,559 - root - INFO - Loaded the best model at epoch 10 for inference
2021-06-12 22:54:01,794 - root - INFO - [2994 1300  961  745 1227 2275 1649  849  467  970 4131  432  356  465
  308 4871]
2021-06-12 22:54:01,795 - root - INFO - Test statistics: t all nodes -- acc: 0.594625, auc: 0.8232437719907406, ap: 1.0
